<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DataConecta CRM | Plataforma Integral con Almacenamiento Local</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #3498db;
            --primary-dark: #2980b9;
            --secondary: #2c3e50;
            --accent: #9b59b6;
            --light: #ecf0f1;
            --dark: #2c3e50;
            --text: #333;
            --text-light: #7f8c8d;
            --success: #2ecc71;
            --warning: #f39c12;
            --danger: #e74c3c;
            --bg-light: #f9fbfd;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: var(--bg-light);
            color: var(--text);
            line-height: 1.6;
        }
        
        .container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        /* Header */
        header {
            background: linear-gradient(135deg, var(--secondary) 0%, var(--dark) 100%);
            color: white;
            padding: 15px 0;
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        
        .header-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo {
            display: flex;
            align-items: center;
            font-size: 24px;
            font-weight: 700;
        }
        
        .logo i {
            margin-right: 10px;
            color: var(--primary);
        }
        
        .nav-menu {
            display: flex;
            list-style: none;
        }
        
        .nav-menu li {
            margin-left: 25px;
        }
        
        .nav-menu a {
            color: white;
            text-decoration: none;
            font-weight: 500;
            transition: color 0.3s;
        }
        
        .nav-menu a:hover {
            color: var(--primary);
        }
        
        .btn {
            padding: 10px 20px;
            border-radius: 4px;
            border: none;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
            text-decoration: none;
            display: inline-block;
        }
        
        .btn-primary {
            background-color: var(--primary);
            color: white;
        }
        
        .btn-primary:hover {
            background-color: var(--primary-dark);
        }
        
        .btn-outline {
            background-color: transparent;
            border: 1px solid white;
            color: white;
        }
        
        .btn-outline:hover {
            background-color: white;
            color: var(--secondary);
        }
        
        .btn-success {
            background-color: var(--success);
            color: white;
        }
        
        .btn-warning {
            background-color: var(--warning);
            color: white;
        }
        
        .btn-danger {
            background-color: var(--danger);
            color: white;
        }
        
        /* Dashboard */
        .dashboard {
            padding: 40px 0;
        }
        
        .dashboard-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .card {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            padding: 20px;
            transition: transform 0.3s, box-shadow 0.3s;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .card-title {
            font-size: 16px;
            font-weight: 600;
            color: var(--text-light);
        }
        
        .card-icon {
            width: 40px;
            height: 40px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
        }
        
        .card-icon.primary {
            background-color: var(--primary);
        }
        
        .card-icon.success {
            background-color: var(--success);
        }
        
        .card-icon.warning {
            background-color: var(--warning);
        }
        
        .card-icon.danger {
            background-color: var(--danger);
        }
        
        .card-value {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 5px;
        }
        
        .card-description {
            font-size: 14px;
            color: var(--text-light);
        }
        
        /* Tabs */
        .tabs {
            display: flex;
            border-bottom: 1px solid var(--light);
            margin-bottom: 20px;
        }
        
        .tab {
            padding: 15px 30px;
            cursor: pointer;
            font-weight: 600;
            color: var(--text-light);
            transition: all 0.3s;
            border-bottom: 3px solid transparent;
        }
        
        .tab.active {
            color: var(--primary);
            border-bottom: 3px solid var(--primary);
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
            animation: fadeIn 0.5s;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        /* Tables */
        .table-container {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            overflow: hidden;
            margin-bottom: 30px;
        }
        
        .table-header {
            padding: 20px;
            border-bottom: 1px solid var(--light);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .table-title {
            font-size: 18px;
            font-weight: 600;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
        }
        
        th, td {
            padding: 15px 20px;
            text-align: left;
            border-bottom: 1px solid var(--light);
        }
        
        th {
            background-color: #f8f9fa;
            font-weight: 600;
            color: var(--text-light);
        }
        
        tr:hover {
            background-color: #f8f9fa;
        }
        
        .status {
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }
        
        .status.active {
            background-color: rgba(46, 204, 113, 0.1);
            color: var(--success);
        }
        
        .status.inactive {
            background-color: rgba(231, 76, 60, 0.1);
            color: var(--danger);
        }
        
        /* Forms */
        .form-container {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            padding: 30px;
            margin-bottom: 30px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-row {
            display: flex;
            gap: 20px;
        }
        
        .form-row .form-group {
            flex: 1;
        }
        
        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
        }
        
        .form-control {
            width: 100%;
            padding: 10px 15px;
            border: 1px solid var(--light);
            border-radius: 4px;
            font-size: 14px;
        }
        
        .form-control:focus {
            outline: none;
            border-color: var(--primary);
        }
        
        textarea.form-control {
            min-height: 100px;
            resize: vertical;
        }
        
        .form-actions {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
            margin-top: 20px;
        }
        
        /* Alerts */
        .alert {
            padding: 15px;
            border-radius: 4px;
            margin-bottom: 20px;
            display: none;
        }
        
        .alert-success {
            background-color: rgba(46, 204, 113, 0.1);
            border: 1px solid var(--success);
            color: var(--success);
        }
        
        .alert-error {
            background-color: rgba(231, 76, 60, 0.1);
            border: 1px solid var(--danger);
            color: var(--danger);
        }
        
        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }
        
        .modal-content {
            background-color: white;
            border-radius: 8px;
            width: 90%;
            max-width: 500px;
            padding: 30px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .modal-title {
            font-size: 20px;
            font-weight: 600;
        }
        
        .close {
            font-size: 24px;
            cursor: pointer;
            color: var(--text-light);
        }
        
        .close:hover {
            color: var(--text);
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .header-container {
                flex-direction: column;
                text-align: center;
            }
            
            .nav-menu {
                margin-top: 20px;
                flex-wrap: wrap;
                justify-content: center;
            }
            
            .nav-menu li {
                margin: 5px 10px;
            }
            
            .tabs {
                flex-direction: column;
            }
            
            .tab {
                padding: 10px 20px;
            }
            
            .form-row {
                flex-direction: column;
                gap: 0;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header>
        <div class="container header-container">
            <div class="logo">
                <i class="fas fa-database"></i>
                <span>DataConecta CRM</span>
            </div>
            <ul class="nav-menu">
                <li><a href="#" class="active">Dashboard</a></li>
                <li><a href="#" id="export-data">Exportar Datos</a></li>
                <li><a href="#" id="import-data">Importar Datos</a></li>
                <li><a href="#" id="clear-data">Limpiar Datos</a></li>
            </ul>
        </div>
    </header>

    <!-- Dashboard -->
    <section class="dashboard">
        <div class="container">
            <div class="dashboard-cards">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">Total Clientes</div>
                        <div class="card-icon primary">
                            <i class="fas fa-users"></i>
                        </div>
                    </div>
                    <div class="card-value" id="total-clients">0</div>
                    <div class="card-description">Clientes registrados en el sistema</div>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">Campañas Activas</div>
                        <div class="card-icon success">
                            <i class="fas fa-chart-line"></i>
                        </div>
                    </div>
                    <div class="card-value" id="active-campaigns">0</div>
                    <div class="card-description">Campañas de marketing activas</div>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">Feedback Recibido</div>
                        <div class="card-icon warning">
                            <i class="fas fa-comments"></i>
                        </div>
                    </div>
                    <div class="card-value" id="total-feedback">0</div>
                    <div class="card-description">Comentarios de experiencia de usuario</div>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">Tasa de Satisfacción</div>
                        <div class="card-icon danger">
                            <i class="fas fa-star"></i>
                        </div>
                    </div>
                    <div class="card-value" id="satisfaction-rate">0%</div>
                    <div class="card-description">Promedio de satisfacción del usuario</div>
                </div>
            </div>
            
            <!-- Tabs -->
            <div class="tabs">
                <div class="tab active" data-tab="clients">Clientes</div>
                <div class="tab" data-tab="campaigns">Campañas</div>
                <div class="tab" data-tab="feedback">Feedback UX</div>
            </div>
            
            <!-- Alerts -->
            <div class="alert alert-success" id="success-alert">
                Operación realizada con éxito.
            </div>
            
            <div class="alert alert-error" id="error-alert">
                Ha ocurrido un error. Por favor, intente nuevamente.
            </div>
            
            <!-- Clients Tab -->
            <div class="tab-content active" id="clients-content">
                <div class="table-container">
                    <div class="table-header">
                        <div class="table-title">Gestión de Clientes</div>
                        <button class="btn btn-primary" id="add-client-btn">Agregar Cliente</button>
                    </div>
                    <table id="clients-table">
                        <thead>
                            <tr>
                                <th>Nombre</th>
                                <th>Email</th>
                                <th>Teléfono</th>
                                <th>Empresa</th>
                                <th>Estado</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="clients-tbody">
                            <!-- Los datos se cargarán dinámicamente -->
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- Campaigns Tab -->
            <div class="tab-content" id="campaigns-content">
                <div class="table-container">
                    <div class="table-header">
                        <div class="table-title">Gestión de Campañas</div>
                        <button class="btn btn-primary" id="add-campaign-btn">Nueva Campaña</button>
                    </div>
                    <table id="campaigns-table">
                        <thead>
                            <tr>
                                <th>Nombre</th>
                                <th>Canal</th>
                                <th>Presupuesto</th>
                                <th>Inicio</th>
                                <th>Fin</th>
                                <th>Estado</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="campaigns-tbody">
                            <!-- Los datos se cargarán dinámicamente -->
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- Feedback Tab -->
            <div class="tab-content" id="feedback-content">
                <div class="table-container">
                    <div class="table-header">
                        <div class="table-title">Feedback de Experiencia de Usuario</div>
                        <button class="btn btn-primary" id="add-feedback-btn">Agregar Feedback</button>
                    </div>
                    <table id="feedback-table">
                        <thead>
                            <tr>
                                <th>Usuario</th>
                                <th>Puntuación</th>
                                <th>Comentarios</th>
                                <th>Fecha</th>
                                <th>Estado</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="feedback-tbody">
                            <!-- Los datos se cargarán dinámicamente -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </section>

    <!-- Client Modal -->
    <div class="modal" id="client-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="client-modal-title">Agregar Cliente</h3>
                <span class="close">&times;</span>
            </div>
            <form id="client-form">
                <input type="hidden" id="client-id">
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label" for="client-name">Nombre</label>
                        <input type="text" class="form-control" id="client-name" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="client-email">Email</label>
                        <input type="email" class="form-control" id="client-email" required>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label" for="client-phone">Teléfono</label>
                        <input type="text" class="form-control" id="client-phone">
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="client-company">Empresa</label>
                        <input type="text" class="form-control" id="client-company">
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label" for="client-status">Estado</label>
                    <select class="form-control" id="client-status">
                        <option value="active">Activo</option>
                        <option value="inactive">Inactivo</option>
                    </select>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-outline" id="cancel-client">Cancelar</button>
                    <button type="submit" class="btn btn-primary">Guardar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Campaign Modal -->
    <div class="modal" id="campaign-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="campaign-modal-title">Nueva Campaña</h3>
                <span class="close">&times;</span>
            </div>
            <form id="campaign-form">
                <input type="hidden" id="campaign-id">
                <div class="form-group">
                    <label class="form-label" for="campaign-name">Nombre</label>
                    <input type="text" class="form-control" id="campaign-name" required>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label" for="campaign-channel">Canal</label>
                        <select class="form-control" id="campaign-channel" required>
                            <option value="email">Email Marketing</option>
                            <option value="social">Redes Sociales</option>
                            <option value="seo">SEO</option>
                            <option value="ads">Publicidad Pagada</option>
                            <option value="content">Marketing de Contenidos</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="campaign-budget">Presupuesto</label>
                        <input type="number" class="form-control" id="campaign-budget" min="0" step="0.01" required>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label" for="campaign-start">Fecha Inicio</label>
                        <input type="date" class="form-control" id="campaign-start" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="campaign-end">Fecha Fin</label>
                        <input type="date" class="form-control" id="campaign-end" required>
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label" for="campaign-status">Estado</label>
                    <select class="form-control" id="campaign-status">
                        <option value="active">Activa</option>
                        <option value="inactive">Inactiva</option>
                        <option value="completed">Completada</option>
                    </select>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-outline" id="cancel-campaign">Cancelar</button>
                    <button type="submit" class="btn btn-primary">Guardar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Feedback Modal -->
    <div class="modal" id="feedback-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="feedback-modal-title">Agregar Feedback</h3>
                <span class="close">&times;</span>
            </div>
            <form id="feedback-form">
                <input type="hidden" id="feedback-id">
                <div class="form-group">
                    <label class="form-label" for="feedback-user">Usuario</label>
                    <input type="text" class="form-control" id="feedback-user" required>
                </div>
                <div class="form-group">
                    <label class="form-label" for="feedback-rating">Puntuación (1-10)</label>
                    <input type="number" class="form-control" id="feedback-rating" min="1" max="10" required>
                </div>
                <div class="form-group">
                    <label class="form-label" for="feedback-comments">Comentarios</label>
                    <textarea class="form-control" id="feedback-comments" required></textarea>
                </div>
                <div class="form-group">
                    <label class="form-label" for="feedback-date">Fecha</label>
                    <input type="date" class="form-control" id="feedback-date" required>
                </div>
                <div class="form-group">
                    <label class="form-label" for="feedback-status">Estado</label>
                    <select class="form-control" id="feedback-status">
                        <option value="reviewed">Revisado</option>
                        <option value="pending">Pendiente</option>
                    </select>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-outline" id="cancel-feedback">Cancelar</button>
                    <button type="submit" class="btn btn-primary">Guardar</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // Datos iniciales de ejemplo
        const initialData = {
            clients: [
                {
                    id: 1,
                    name: "María González",
                    email: "maria.gonzalez@empresa.com",
                    phone: "+34 612 345 678",
                    company: "Tech Solutions",
                    status: "active"
                },
                {
                    id: 2,
                    name: "Carlos Rodríguez",
                    email: "carlos.rodriguez@consultores.com",
                    phone: "+34 623 456 789",
                    company: "Consultores Asociados",
                    status: "active"
                },
                {
                    id: 3,
                    name: "Ana Martínez",
                    email: "ana.martinez@innovacion.com",
                    phone: "+34 634 567 890",
                    company: "Innovación Digital",
                    status: "inactive"
                }
            ],
            campaigns: [
                {
                    id: 1,
                    name: "Lanzamiento Producto X",
                    channel: "email",
                    budget: 5000,
                    start: "2023-05-01",
                    end: "2023-06-30",
                    status: "active"
                },
                {
                    id: 2,
                    name: "Webinar UX Avanzado",
                    channel: "social",
                    budget: 2500,
                    start: "2023-04-15",
                    end: "2023-05-15",
                    status: "completed"
                }
            ],
            feedback: [
                {
                    id: 1,
                    user: "Usuario Anónimo",
                    rating: 9,
                    comments: "Interfaz intuitiva y fácil de usar",
                    date: "2023-05-18",
                    status: "reviewed"
                },
                {
                    id: 2,
                    user: "Carlos López",
                    rating: 7,
                    comments: "Funcionalidades útiles pero lenta en móvil",
                    date: "2023-05-16",
                    status: "reviewed"
                },
                {
                    id: 3,
                    user: "Usuario Anónimo",
                    rating: 8,
                    comments: "Buen diseño pero falta opción de exportación",
                    date: "2023-05-14",
                    status: "pending"
                }
            ]
        };

        // Estado de la aplicación
        let appState = {
            clients: [],
            campaigns: [],
            feedback: [],
            nextId: {
                clients: 1,
                campaigns: 1,
                feedback: 1
            }
        };

        // Inicializar la aplicación
        function initApp() {
            loadData();
            renderDashboard();
            renderClients();
            renderCampaigns();
            renderFeedback();
            setupEventListeners();
        }

        // Cargar datos del localStorage o inicializar con datos de ejemplo
        function loadData() {
            const savedData = localStorage.getItem('dataconecta-crm');
            
            if (savedData) {
                appState = JSON.parse(savedData);
            } else {
                appState.clients = initialData.clients;
                appState.campaigns = initialData.campaigns;
                appState.feedback = initialData.feedback;
                
                // Calcular el siguiente ID para cada tipo
                appState.nextId.clients = Math.max(...appState.clients.map(c => c.id)) + 1;
                appState.nextId.campaigns = Math.max(...appState.campaigns.map(c => c.id)) + 1;
                appState.nextId.feedback = Math.max(...appState.feedback.map(f => f.id)) + 1;
                
                saveData();
            }
        }

        // Guardar datos en localStorage
        function saveData() {
            localStorage.setItem('dataconecta-crm', JSON.stringify(appState));
        }

        // Renderizar el dashboard con estadísticas
        function renderDashboard() {
            document.getElementById('total-clients').textContent = appState.clients.length;
            
            const activeCampaigns = appState.campaigns.filter(c => c.status === 'active').length;
            document.getElementById('active-campaigns').textContent = activeCampaigns;
            
            document.getElementById('total-feedback').textContent = appState.feedback.length;
            
            if (appState.feedback.length > 0) {
                const avgRating = appState.feedback.reduce((sum, f) => sum + f.rating, 0) / appState.feedback.length;
                const satisfactionRate = (avgRating / 10 * 100).toFixed(0);
                document.getElementById('satisfaction-rate').textContent = `${satisfactionRate}%`;
            } else {
                document.getElementById('satisfaction-rate').textContent = '0%';
            }
        }

        // Renderizar la tabla de clientes
        function renderClients() {
            const tbody = document.getElementById('clients-tbody');
            tbody.innerHTML = '';
            
            appState.clients.forEach(client => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${client.name}</td>
                    <td>${client.email}</td>
                    <td>${client.phone}</td>
                    <td>${client.company}</td>
                    <td><span class="status ${client.status}">${client.status === 'active' ? 'Activo' : 'Inactivo'}</span></td>
                    <td>
                        <button class="btn btn-outline edit-client" data-id="${client.id}">Editar</button>
                        <button class="btn btn-danger delete-client" data-id="${client.id}">Eliminar</button>
                    </td>
                `;
                tbody.appendChild(tr);
            });
        }

        // Renderizar la tabla de campañas
        function renderCampaigns() {
            const tbody = document.getElementById('campaigns-tbody');
            tbody.innerHTML = '';
            
            appState.campaigns.forEach(campaign => {
                const tr = document.createElement('tr');
                const channelNames = {
                    email: 'Email Marketing',
                    social: 'Redes Sociales',
                    seo: 'SEO',
                    ads: 'Publicidad Pagada',
                    content: 'Marketing de Contenidos'
                };
                
                const statusNames = {
                    active: 'Activa',
                    inactive: 'Inactiva',
                    completed: 'Completada'
                };
                
                tr.innerHTML = `
                    <td>${campaign.name}</td>
                    <td>${channelNames[campaign.channel]}</td>
                    <td>$${campaign.budget.toLocaleString()}</td>
                    <td>${formatDate(campaign.start)}</td>
                    <td>${formatDate(campaign.end)}</td>
                    <td><span class="status ${campaign.status}">${statusNames[campaign.status]}</span></td>
                    <td>
                        <button class="btn btn-outline edit-campaign" data-id="${campaign.id}">Editar</button>
                        <button class="btn btn-danger delete-campaign" data-id="${campaign.id}">Eliminar</button>
                    </td>
                `;
                tbody.appendChild(tr);
            });
        }

        // Renderizar la tabla de feedback
        function renderFeedback() {
            const tbody = document.getElementById('feedback-tbody');
            tbody.innerHTML = '';
            
            appState.feedback.forEach(feedback => {
                const tr = document.createElement('tr');
                const statusNames = {
                    reviewed: 'Revisado',
                    pending: 'Pendiente'
                };
                
                // Crear estrellas para la puntuación
                let stars = '';
                for (let i = 1; i <= 10; i++) {
                    stars += i <= feedback.rating ? '★' : '☆';
                }
                
                tr.innerHTML = `
                    <td>${feedback.user}</td>
                    <td>${stars} (${feedback.rating}/10)</td>
                    <td>${feedback.comments}</td>
                    <td>${formatDate(feedback.date)}</td>
                    <td><span class="status ${feedback.status}">${statusNames[feedback.status]}</span></td>
                    <td>
                        <button class="btn btn-outline edit-feedback" data-id="${feedback.id}">Editar</button>
                        <button class="btn btn-danger delete-feedback" data-id="${feedback.id}">Eliminar</button>
                    </td>
                `;
                tbody.appendChild(tr);
            });
        }

        // Formatear fecha para mostrar
        function formatDate(dateString) {
            const options = { year: 'numeric', month: 'short', day: 'numeric' };
            return new Date(dateString).toLocaleDateString('es-ES', options);
        }

        // Configurar event listeners
        function setupEventListeners() {
            // Tabs
            document.querySelectorAll('.tab').forEach(tab => {
                tab.addEventListener('click', () => {
                    // Remove active class from all tabs
                    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                    document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                    
                    // Add active class to clicked tab
                    tab.classList.add('active');
                    document.getElementById(`${tab.dataset.tab}-content`).classList.add('active');
                });
            });
            
            // Botones para agregar
            document.getElementById('add-client-btn').addEventListener('click', () => openClientModal());
            document.getElementById('add-campaign-btn').addEventListener('click', () => openCampaignModal());
            document.getElementById('add-feedback-btn').addEventListener('click', () => openFeedbackModal());
            
            // Formularios
            document.getElementById('client-form').addEventListener('submit', handleClientSubmit);
            document.getElementById('campaign-form').addEventListener('submit', handleCampaignSubmit);
            document.getElementById('feedback-form').addEventListener('submit', handleFeedbackSubmit);
            
            // Botones de cancelar
            document.getElementById('cancel-client').addEventListener('click', () => closeModal('client-modal'));
            document.getElementById('cancel-campaign').addEventListener('click', () => closeModal('campaign-modal'));
            document.getElementById('cancel-feedback').addEventListener('click', () => closeModal('feedback-modal'));
            
            // Cerrar modales con la X
            document.querySelectorAll('.close').forEach(closeBtn => {
                closeBtn.addEventListener('click', function() {
                    this.closest('.modal').style.display = 'none';
                });
            });
            
            // Cerrar modales al hacer clic fuera
            window.addEventListener('click', (e) => {
                if (e.target.classList.contains('modal')) {
                    e.target.style.display = 'none';
                }
            });
            
            // Delegación de eventos para botones de editar y eliminar
            document.getElementById('clients-tbody').addEventListener('click', (e) => {
                if (e.target.classList.contains('edit-client')) {
                    const id = parseInt(e.target.dataset.id);
                    editClient(id);
                } else if (e.target.classList.contains('delete-client')) {
                    const id = parseInt(e.target.dataset.id);
                    deleteClient(id);
                }
            });
            
            document.getElementById('campaigns-tbody').addEventListener('click', (e) => {
                if (e.target.classList.contains('edit-campaign')) {
                    const id = parseInt(e.target.dataset.id);
                    editCampaign(id);
                } else if (e.target.classList.contains('delete-campaign')) {
                    const id = parseInt(e.target.dataset.id);
                    deleteCampaign(id);
                }
            });
            
            document.getElementById('feedback-tbody').addEventListener('click', (e) => {
                if (e.target.classList.contains('edit-feedback')) {
                    const id = parseInt(e.target.dataset.id);
                    editFeedback(id);
                } else if (e.target.classList.contains('delete-feedback')) {
                    const id = parseInt(e.target.dataset.id);
                    deleteFeedback(id);
                }
            });
            
            // Exportar datos
            document.getElementById('export-data').addEventListener('click', exportData);
            
            // Importar datos
            document.getElementById('import-data').addEventListener('click', () => {
                document.getElementById('import-file').click();
            });
            
            // Limpiar datos
            document.getElementById('clear-data').addEventListener('click', clearData);
        }

        // Funciones para abrir modales
        function openClientModal(client = null) {
            const modal = document.getElementById('client-modal');
            const title = document.getElementById('client-modal-title');
            const form = document.getElementById('client-form');
            
            if (client) {
                title.textContent = 'Editar Cliente';
                document.getElementById('client-id').value = client.id;
                document.getElementById('client-name').value = client.name;
                document.getElementById('client-email').value = client.email;
                document.getElementById('client-phone').value = client.phone;
                document.getElementById('client-company').value = client.company;
                document.getElementById('client-status').value = client.status;
            } else {
                title.textContent = 'Agregar Cliente';
                form.reset();
                document.getElementById('client-id').value = '';
            }
            
            modal.style.display = 'flex';
        }

        function openCampaignModal(campaign = null) {
            const modal = document.getElementById('campaign-modal');
            const title = document.getElementById('campaign-modal-title');
            const form = document.getElementById('campaign-form');
            
            if (campaign) {
                title.textContent = 'Editar Campaña';
                document.getElementById('campaign-id').value = campaign.id;
                document.getElementById('campaign-name').value = campaign.name;
                document.getElementById('campaign-channel').value = campaign.channel;
                document.getElementById('campaign-budget').value = campaign.budget;
                document.getElementById('campaign-start').value = campaign.start;
                document.getElementById('campaign-end').value = campaign.end;
                document.getElementById('campaign-status').value = campaign.status;
            } else {
                title.textContent = 'Nueva Campaña';
                form.reset();
                document.getElementById('campaign-id').value = '';
                
                // Establecer fechas por defecto
                const today = new Date().toISOString().split('T')[0];
                document.getElementById('campaign-start').value = today;
                
                const nextMonth = new Date();
                nextMonth.setMonth(nextMonth.getMonth() + 1);
                document.getElementById('campaign-end').value = nextMonth.toISOString().split('T')[0];
            }
            
            modal.style.display = 'flex';
        }

        function openFeedbackModal(feedback = null) {
            const modal = document.getElementById('feedback-modal');
            const title = document.getElementById('feedback-modal-title');
            const form = document.getElementById('feedback-form');
            
            if (feedback) {
                title.textContent = 'Editar Feedback';
                document.getElementById('feedback-id').value = feedback.id;
                document.getElementById('feedback-user').value = feedback.user;
                document.getElementById('feedback-rating').value = feedback.rating;
                document.getElementById('feedback-comments').value = feedback.comments;
                document.getElementById('feedback-date').value = feedback.date;
                document.getElementById('feedback-status').value = feedback.status;
            } else {
                title.textContent = 'Agregar Feedback';
                form.reset();
                document.getElementById('feedback-id').value = '';
                
                // Establecer fecha por defecto (hoy)
                const today = new Date().toISOString().split('T')[0];
                document.getElementById('feedback-date').value = today;
            }
            
            modal.style.display = 'flex';
        }

        // Funciones para cerrar modales
        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        // Manejadores de formularios
        function handleClientSubmit(e) {
            e.preventDefault();
            
            const id = document.getElementById('client-id').value;
            const clientData = {
                name: document.getElementById('client-name').value,
                email: document.getElementById('client-email').value,
                phone: document.getElementById('client-phone').value,
                company: document.getElementById('client-company').value,
                status: document.getElementById('client-status').value
            };
            
            if (id) {
                // Editar cliente existente
                updateClient(parseInt(id), clientData);
            } else {
                // Agregar nuevo cliente
                addClient(clientData);
            }
            
            closeModal('client-modal');
        }

        function handleCampaignSubmit(e) {
            e.preventDefault();
            
            const id = document.getElementById('campaign-id').value;
            const campaignData = {
                name: document.getElementById('campaign-name').value,
                channel: document.getElementById('campaign-channel').value,
                budget: parseFloat(document.getElementById('campaign-budget').value),
                start: document.getElementById('campaign-start').value,
                end: document.getElementById('campaign-end').value,
                status: document.getElementById('campaign-status').value
            };
            
            if (id) {
                // Editar campaña existente
                updateCampaign(parseInt(id), campaignData);
            } else {
                // Agregar nueva campaña
                addCampaign(campaignData);
            }
            
            closeModal('campaign-modal');
        }

        function handleFeedbackSubmit(e) {
            e.preventDefault();
            
            const id = document.getElementById('feedback-id').value;
            const feedbackData = {
                user: document.getElementById('feedback-user').value,
                rating: parseInt(document.getElementById('feedback-rating').value),
                comments: document.getElementById('feedback-comments').value,
                date: document.getElementById('feedback-date').value,
                status: document.getElementById('feedback-status').value
            };
            
            if (id) {
                // Editar feedback existente
                updateFeedback(parseInt(id), feedbackData);
            } else {
                // Agregar nuevo feedback
                addFeedback(feedbackData);
            }
            
            closeModal('feedback-modal');
        }

        // Funciones CRUD para clientes
        function addClient(clientData) {
            const newClient = {
                id: appState.nextId.clients++,
                ...clientData
            };
            
            appState.clients.push(newClient);
            saveData();
            renderClients();
            renderDashboard();
            showAlert('success', 'Cliente agregado correctamente');
        }

        function editClient(id) {
            const client = appState.clients.find(c => c.id === id);
            if (client) {
                openClientModal(client);
            }
        }

        function updateClient(id, clientData) {
            const index = appState.clients.findIndex(c => c.id === id);
            if (index !== -1) {
                appState.clients[index] = { id, ...clientData };
                saveData();
                renderClients();
                renderDashboard();
                showAlert('success', 'Cliente actualizado correctamente');
            }
        }

        function deleteClient(id) {
            if (confirm('¿Está seguro de que desea eliminar este cliente?')) {
                appState.clients = appState.clients.filter(c => c.id !== id);
                saveData();
                renderClients();
                renderDashboard();
                showAlert('success', 'Cliente eliminado correctamente');
            }
        }

        // Funciones CRUD para campañas
        function addCampaign(campaignData) {
            const newCampaign = {
                id: appState.nextId.campaigns++,
                ...campaignData
            };
            
            appState.campaigns.push(newCampaign);
            saveData();
            renderCampaigns();
            renderDashboard();
            showAlert('success', 'Campaña agregada correctamente');
        }

        function editCampaign(id) {
            const campaign = appState.campaigns.find(c => c.id === id);
            if (campaign) {
                openCampaignModal(campaign);
            }
        }

        function updateCampaign(id, campaignData) {
            const index = appState.campaigns.findIndex(c => c.id === id);
            if (index !== -1) {
                appState.campaigns[index] = { id, ...campaignData };
                saveData();
                renderCampaigns();
                renderDashboard();
                showAlert('success', 'Campaña actualizada correctamente');
            }
        }

        function deleteCampaign(id) {
            if (confirm('¿Está seguro de que desea eliminar esta campaña?')) {
                appState.campaigns = appState.campaigns.filter(c => c.id !== id);
                saveData();
                renderCampaigns();
                renderDashboard();
                showAlert('success', 'Campaña eliminada correctamente');
            }
        }

        // Funciones CRUD para feedback
        function addFeedback(feedbackData) {
            const newFeedback = {
                id: appState.nextId.feedback++,
                ...feedbackData
            };
            
            appState.feedback.push(newFeedback);
            saveData();
            renderFeedback();
            renderDashboard();
            showAlert('success', 'Feedback agregado correctamente');
        }

        function editFeedback(id) {
            const feedback = appState.feedback.find(f => f.id === id);
            if (feedback) {
                openFeedbackModal(feedback);
            }
        }

        function updateFeedback(id, feedbackData) {
            const index = appState.feedback.findIndex(f => f.id === id);
            if (index !== -1) {
                appState.feedback[index] = { id, ...feedbackData };
                saveData();
                renderFeedback();
                renderDashboard();
                showAlert('success', 'Feedback actualizado correctamente');
            }
        }

        function deleteFeedback(id) {
            if (confirm('¿Está seguro de que desea eliminar este feedback?')) {
                appState.feedback = appState.feedback.filter(f => f.id !== id);
                saveData();
                renderFeedback();
                renderDashboard();
                showAlert('success', 'Feedback eliminado correctamente');
            }
        }

        // Mostrar alertas
        function showAlert(type, message) {
            const alert = document.getElementById(`${type}-alert`);
            alert.textContent = message;
            alert.style.display = 'block';
            
            setTimeout(() => {
                alert.style.display = 'none';
            }, 3000);
        }

        // Exportar datos
        function exportData() {
            const dataStr = JSON.stringify(appState, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            
            const link = document.createElement('a');
            link.href = URL.createObjectURL(dataBlob);
            link.download = 'dataconecta-crm-backup.json';
            link.click();
            
            showAlert('success', 'Datos exportados correctamente');
        }

        // Importar datos
        function setupImport() {
            const fileInput = document.createElement('input');
            fileInput.type = 'file';
            fileInput.accept = '.json';
            fileInput.id = 'import-file';
            fileInput.style.display = 'none';
            document.body.appendChild(fileInput);
            
            fileInput.addEventListener('change', (e) => {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = (event) => {
                        try {
                            const importedData = JSON.parse(event.target.result);
                            
                            if (confirm('¿Está seguro de que desea importar estos datos? Se sobrescribirán los datos actuales.')) {
                                appState = importedData;
                                saveData();
                                renderClients();
                                renderCampaigns();
                                renderFeedback();
                                renderDashboard();
                                showAlert('success', 'Datos importados correctamente');
                            }
                        } catch (error) {
                            showAlert('error', 'Error al importar los datos. El archivo puede estar corrupto.');
                        }
                    };
                    reader.readAsText(file);
                }
                
                // Resetear el input
                fileInput.value = '';
            });
        }

        // Limpiar datos
        function clearData() {
            if (confirm('¿Está seguro de que desea eliminar todos los datos? Esta acción no se puede deshacer.')) {
                localStorage.removeItem('dataconecta-crm');
                appState = {
                    clients: [],
                    campaigns: [],
                    feedback: [],
                    nextId: {
                        clients: 1,
                        campaigns: 1,
                        feedback: 1
                    }
                };
                
                renderClients();
                renderCampaigns();
                renderFeedback();
                renderDashboard();
                showAlert('success', 'Todos los datos han sido eliminados');
            }
        }

        // Inicializar la aplicación cuando el DOM esté listo
        document.addEventListener('DOMContentLoaded', () => {
            initApp();
            setupImport();
        });
    </script>
</body>
</html>
